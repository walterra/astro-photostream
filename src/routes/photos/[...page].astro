---
/**
 * Photo gallery pagination - consolidated route using shared utilities
 * Handles URLs: /photos/1, /photos/2, /photos/3, etc.
 */
import { config } from 'virtual:astro-photostream/config';
import PhotoGalleryContent from '../../components/PhotoGalleryContent.astro';
import SeoHead from '../../components/SeoHead.astro';
import { createPhotoPagination, getPaginationMetadata } from '../../utils/pagination.js';
import { calculateDateRange } from '../../utils/photo-data.js';
import { generateGalleryPageSeo } from '../../utils/seo.js';
import type { GetStaticPaths } from 'astro';

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  return await createPhotoPagination(paginate, config.gallery.itemsPerPage, config);
};

// Get paginated data from Astro's paginate function
const { page, totalPhotos } = Astro.props;
const { photos, currentPage, totalPages } = getPaginationMetadata(page);

// Calculate date range for SEO
const dateRange = calculateDateRange(photos);

// Generate SEO metadata
const seoData = generateGalleryPageSeo(
  currentPage,
  totalPages,
  totalPhotos,
  dateRange,
  config.seo,
  Astro.url
);
---

<html lang="en">
  <head>
    <SeoHead 
      title={seoData.title}
      description={seoData.description}
      canonical={seoData.canonical}
      ogImageUrl={seoData.ogImageUrl}
      jsonLd={seoData.jsonLd}
      siteName={config.seo.siteName}
    />
    
    <!-- Pagination SEO -->
    {page.url.prev && <link rel="prev" href={page.url.prev} />}
    {page.url.next && <link rel="next" href={page.url.next} />}
  </head>
  
  <body>
    <PhotoGalleryContent 
      photos={photos}
      page={page}
      totalPhotos={totalPhotos}
      config={config}
      showMap={true}
    />
  </body>
</html>