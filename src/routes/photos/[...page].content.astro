---
/**
 * Photo gallery pagination with layout wrapper - consolidated route using shared utilities
 * Handles URLs: /photos/1, /photos/2, /photos/3, etc.
 */
import { config } from 'virtual:astro-photostream/config';
import { LayoutComponent } from 'virtual:astro-photostream/layout-wrapper';
import { layoutProps } from 'virtual:astro-photostream/layout';
import PhotoGalleryContent from '../../components/PhotoGalleryContent.astro';
import { createPhotoPagination, getPaginationMetadata } from '../../utils/pagination.js';
import { calculateDateRange } from '../../utils/photo-data.js';
import { generateGalleryPageSeo } from '../../utils/seo.js';
import type { GetStaticPaths } from 'astro';

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  return await createPhotoPagination(paginate, config.gallery.itemsPerPage, config);
};

// Get paginated data from Astro's paginate function
const { page, totalPhotos } = Astro.props;
const { photos, currentPage, totalPages } = getPaginationMetadata(page);

// Calculate date range for SEO
const dateRange = calculateDateRange(photos);

// Generate SEO metadata
const seoData = generateGalleryPageSeo(
  currentPage,
  totalPages,
  totalPhotos,
  dateRange,
  config.seo,
  Astro.url
);
---

<LayoutComponent {...layoutProps} title={seoData.title} description={seoData.description}>
  <PhotoGalleryContent 
    photos={photos}
    page={page}
    totalPhotos={totalPhotos}
    config={config}
    showMap={true}
  />
</LayoutComponent>
